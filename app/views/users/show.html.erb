<div id="user-sh-container">

  <div id="user-sh-header-info">

    <% if @user.avatar.attached? %> 
      <div class="user-sh-avatar background-image" style="background-image: url('<%= url_for(@user.avatar) %>');"></div>
    <% else %>
      <div class="user-sh-avatar background-image" style="background-image: url('<%= "/assets/default_profile.jpg" %>');"></div>
    <% end %>

    <div>

      <div id="user-sh-info-1">
        <p class="user-sh-username"><%= @user.username %></p>

        <% if current_user != @user %>
          <div id="user-sh-mnf-links">
            <%= link_to "Message", conversations_path(sender_id: current_user.id, recipient_id: @user.id), method: "post", class: "user-sh-mnf-link" %>

            <% @follow = Follow.find_by(user_id: current_user.id, following_id: @user.id) %>

            <% follow_txt = @follow ? "Unfollow" : "Follow" %>

            <%= link_to follow_txt, ajax_follows_update_follow_path(user_id: current_user.id, following_id: @user.id, html_id: "follow-#{@user.id}"), method: :put, remote: true, id: "follow-#{@user.id}", class: "user-sh-mnf-link" %>
          </div>

        <% else %>
          <%= link_to edit_user_registration_path, id: "user-sh-edit-link" do %>
            <span class="user-sh-edit-txt">Edit Profile</span>
            <span class="user-sh-cog"><i class="fas fa-cog"></i></span>
          <% end %>
        <% end %>
      </div>

      <div id="user-sh-info-2">
        <p class="user-sh-info-stats">
          <strong><%= @user.posts.count %></strong> <%= "post".pluralize(@user.posts.count) %>
        </p>

        <p class="user-sh-info-stats">
          <strong><%= @user.followers.count %></strong> <%= "follower".pluralize(@user.followers.count) %>
        </p>

        <p class="user-sh-info-stats">
          <strong><%= @user.following.count %></strong> following
        </p>
      </div>

      <h3 id="user-sh-fullname">
        <%= "#{@user.first_name.downcase.capitalize} #{@user.last_name.downcase.capitalize}" %>
      </h3>

      <% if @user.bio === nil || @user.bio.strip != "" %>
        <p id="user-sh-bio">
          <%= @user.bio %>
        </p>
      <% end %>

    </div>
  </div>

  <div id="user-sh-parent-info-div">
    <div id="user-sh-post-header-links">
      <p class="user-sh-sp"><i class="fas fa-th user-sh-th"></i> Posts<p>

      <%= link_to saved_posts_path, class: "user-sh-sp" do %>
        <p><i class="far fa-bookmark user-sh-bookmark"></i> Saved</p>
      <% end %>
    </div>
  </div>

  <% if @user_posts.length != 0 %>
    
    <div id="user-sh-post-grid">
      <% @user_posts.each do |post| %>

        <% if post.class.method_defined? :image %>

          <%= link_to post, class: "user-sh-post-link" do %>
            <div class="user-sh-tile-div background-image" style="background-image: url('<%= url_for(post.image) %>');">

              <div class="tinted-tile">
                <p class="post-index-info">
                  <i class="fas fa-heart us-icon"></i>
                  <span class="us-icon-like">
                    <%= post.likes.count %>
                  </span>
                  
                  <i class="fas fa-comment us-icon"></i>
                  <span>
                    <%= post.comments.count %>
                  </span>
                </p>
              </div>
              
            </div>
          <% end %>
          
        <% elsif post.class.method_defined? :clip %>

          <%= link_to post, class: "user-sh-post-link" do %>
            <div class="post-index-tile-div video-container">
              <%= video_tag url_for(post.clip), class: "post-index-video" %>

              <div class="tinted-tile">
                <p class="post-index-info">
                  <i class="fas fa-heart us-icon"></i>
                  <span class="us-icon-like">
                    <%= post.likes.count %>
                  </span>

                  <i class="fas fa-comment us-icon"></i>
                  <span>
                    <%= post.comments.count %>
                  </span>
                </p>
              </div>
            </div>
          <% end %>

        <% end %>

      <% end %>
    </div>

  <% else %>
    <% if current_user === @user %>
      <h2>You haven't posted anything!</h2>
      <%= link_to "Add Post", new_post_path %>
    <% else %>
      <h2><%= "#{@user.first_name} #{@user.last_name} hasn't posted yet." %></h2>
    <% end %>
  <% end %>
</div>